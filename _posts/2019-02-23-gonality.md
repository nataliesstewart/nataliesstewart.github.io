---
layout: post
title:  "Gonality of modular curves"
date:   2019-02-23
categories: algebraic-geometry
---

<script type="text/javascript" async=""
src="https://www.google-analytics.com/analytics.js"></script>
<script async=""
src="https://www.googletagmanager.com/gtag/js?id=UA-109004213-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

        gtag('config', 'UA-109004213-1');
</script>
<script type="text/javascript"
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

$$\newcommand{\KO}{\mathrm{KO}} \newcommand{\TMF}{\mathrm{TMF}}
\newcommand{\KU}{\mathrm{KU}} \newcommand{\Mfg}{M_\mathrm{fg}}
\newcommand{\spec}{\mathrm{Spec}\ } \newcommand{\dX}{\mathcal{X}}
\newcommand{\co}{\mathcal{O}} \newcommand{\Z}{\mathbf{Z}}
\newcommand{\top}{\mathrm{top}} \newcommand{\E}{\mathbf{E}}
\newcommand{\GG}{\mathbf{G}} \newcommand{\DD}{\mathbf{D}}
\newcommand{\Mell}{M_\mathrm{ell}} \newcommand{\ce}{\mathcal{E}}
\newcommand{\H}{\mathrm{H}} \newcommand{\dR}{\mathrm{dR}}
\newcommand{\cf}{\mathcal{F}} \newcommand{\FF}{\mathbf{F}}
\newcommand{\spf}{\mathrm{Spf}\ } \newcommand{\cA}{\mathcal{A}}
\newcommand{\Mcub}{M_\mathrm{cub}} \newcommand{\Mqd}{M_\mathrm{qd}}
\newcommand{\Aut}{\mathrm{Aut}} \newcommand{\tmf}{\mathrm{tmf}}
\newcommand{\Tmf}{\mathrm{Tmf}} \newcommand{\Map}{\mathrm{Map}}
\newcommand{\Ext}{\mathrm{Ext}} \newcommand{\End}{\mathrm{End}}
\newcommand{\cg}{\mathcal{G}} \newcommand{\Hom}{\mathrm{Hom}}
\newcommand{BP}[1]{\mathrm{BP}\langle #1\rangle} \newcommand{\QQ}{\mathbf{Q}}
\newcommand{\PP}{\mathbf{P}} \newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\proj}{\mathrm{Proj}\ } \newcommand{\Ltwo}{L_{K(2)}}
\newcommand{\Eoo}{\mathbf{E}_\infty} \newcommand{\ol}[1]{\overline #1}
\newcommand{\pic}{\mathrm{Pic}} \newcommand{\d}{\mathrm{d}}
\newcommand{\F}{\mathrm{F}} \newcommand{\wt}[1]{\widetilde #1}
\newcommand{\AA}{\mathbf{A}} \newcommand{\PP}{\mathbf{P}}
\newcommand{\top}{\mathrm{top}} \newcommand{\der}{\mathrm{der}}
\newcommand{\M}{M} \newcommand{\colim}{\mathrm{colim}\ }
\newcommand{\GL}{\mathrm{GL}} \newcommand{\W}{\mathrm{W}}
\newcommand{\et}{\mathrm{et}} \newcommand{\im}{\mathrm{im}}
\newcommand{\tors}{\mathrm{tors}} \renewcommand{\div}{\mathrm{div}}$$

This semester, I'm working on a project under [Drew
Sutherland](http://math.mit.edu/~drew/) and [Maarten
Derickx](http://maartenderickx.nl) that hopes to extend [Mazur's
classification](http://www.numdam.org/article/PMIHES_1977__47__33_0.pdf) of
torsion subgroups of elliptic curves. Fix a number field $$K$$, and let $$E$$
be an elliptic curve over $$K$$. The Mordell-Weil theorem states that $$E(K)$$
is a finitely generated abelian group, and it is classical that the torsion
subgroup is generated by two elements; therefore, the torsion subgroup
$$E(K)_\tors$$ is isomorphic to $$\Z/m \oplus \Z/mn$$ for some pair of integers
$$m,n\geq 1$$. It is known by work of Merel that for a fixed degree $$d$$,
there is only a finite set $$\Phi(d)$$ of possibilites of pairs $$(m,mn)$$ of
torsion points of elliptic curves over number fields of degree $$d$$.

Mazur's groundbreaking result computes all possibilities of $$m$$ and $$mn$$
when $$d=1$$: he shows that

$$\Phi(1) = \{(1,n):1\leq n\leq 12, n\neq 11\} \cup \{(2,2n): 1\leq n\leq
4\}.$$

Computing $$\Phi(d)$$ for general values of $$d$$ is harder, so one can instead
attempt to solve the weaker problem of computing the subset $$\Phi^\infty(d)
\subseteq \Phi(d)$$ of torsion subgroups which arise for infinitely many
*$$\ol{\QQ}$$-isomorphism classes* of elliptic curves over number fields of
degree $$d$$. [Derickx and Sutherland](https://arxiv.org/abs/1608.07549)
provided a method of computing $$\Phi^\infty(d)$$, which we now recall.

The (rational model for the) modular curve $$X_1(m,mn)$$ naturally lives (via
the Weil pairing) over $$K_m := \QQ(\zeta_m)$$, and one can prove that the pair
$$(m,mn)$$ lives in $$\Phi^\infty(d)$$ if the function field $$K_m(X_1(m,mn))$$
contains a point of degree $$d/\phi(m)$$. The converse is true if the Jacobian
$$J_1(m,mn)$$ is of rank zero (i.e., is entirely torsion). Suppose that we want
to prove that $$\Phi^\infty(d)$$ is equal to a set $$T$$ of pairs $$(m,mn)$$.
Then the above discussion suggests that one should first prove that for each
$$(m,mn)\in T$$, the field $$K_m(X_1(m,mn))$$ contains a point of degree
$$d/\phi(m)$$. Then, define a set $$T_1 = \{(m,mn):\phi(d)|m, \ B(m,mn) \leq
2d\}$$, where $$B(m,mn)$$ is the Abramovich-Kim-Sarnak bound. If the Jacobian
$$J_1(m,mn)$$ is of rank zero for all $$(m,mn)\in T_1$$, the above discussion
implies that $$K_m(X_1(m,mn))$$ has a point of degree $$d/\phi(m)$$ if and only
if $$(m,mn)\in \Phi^\infty(d)$$. Let $$T_2 = \{(m,mn):\phi(d)|m, \ B(m,mn) \leq
d\} \subseteq T_1$$, so that $$\Phi^\infty(d) \subseteq T_2$$ by general
theory. Then, to show that $$\Phi^\infty(d)=T$$, it suffices to prove that for
each $$(m,mn) \in T_2-T$$, the field $$K_m(X_1(m,mn))$$ has no functions of
degree $$d/\phi(m)$$.

For $$d\leq 8$$, all steps except for the final one have been completed by
Derickx-Sutherland. The hardest part is showing that the field
$$K_m(X_1(m,mn))$$ has no functions of degree $$d/\phi(m)$$. For this, one
relies on the general observation that since $$J_1(m,mn)$$ has rank $$0$$ for
all $$(m,mn) \in T_2\subseteq T_1$$, we have $$d(X_1(m,mn)) =
\gamma(X_1(m,mn))$$, where:

* $$d(X)$$ is the least integer for which the set $$\{x\in
  X(\ol{K}):[K(a):K]=d\}$$ has infinitely many elements; and
* $$\gamma(X)$$ is the *gonality* of $$X$$, defined as the minimal degree of a
  finite morphism $$X\to \PP^1$$; equivalently (at least if $$X$$ is smooth),
this is the minimal degree of a line bundle on $$X$$ generated by at least two
global sections. If $$X$$ is a curve over $$\QQ$$ with minimal regular model
$$\dX$$ which has good reduction at $$p$$, then $$\gamma(X) \geq
\gamma(\dX_{\FF_p})$$. This is essentially because the map
$$\mathrm{Pic}(\dX_{\Z_{(p)}}) \to \mathrm{Pic}(X)$$ is surjective, so you can
choose a lift of a minimal "gonal" line bundle over $$X$$ to
$$\dX_{\Z_{(p)}}$$, and then specialize to the special fiber.

To prove that $$K_m(X_1(m,mn))$$ has no functions of degree $$d/\phi(m)$$, it
therefore suffices to show that $$\gamma(X_1(m,mn))>d/\phi(m)$$. The curve
$$X_1(m,mn)$$ has good reduction at all primes not dividing $$mn$$, so if $$p$$
is such a prime, then $$\gamma(X_1(m,mn)_{\FF_p}) \leq \gamma(X_1(m,mn))$$. It
therefore suffices to prove that there is a prime $$p\not{\mid} mn$$ such that
$$\gamma(X_1(m,mn)_{\FF_p})>d/\phi(m)$$.

Computing this gonality is the primary bottleneck: Derickx and Sutherland used
a brute-force algorithm to compute $$\gamma(X_1(m,mn)_{\FF_p})$$ for $$d\leq
6$$ by running over Riemann-Roch spaces, which we will now briefly describe.
Let $$X$$ be a curve over a field $$k$$; then, there is a nonconstant function
$$f:X\to \PP^1$$ of degree $$d$$ if and only if there is a(n effective Cartier)
divisor $$D$$ on $$X$$ of degree $$d$$ such that $$\H^0(X;\co_X(D))$$ contains
a non-constant function, i.e., if and only if $$\dim \H^0(X;\co_X(D)) \geq 2$$.
Therefore, if $$\div_d(X) = \{\text{divisors }D\text{ on }X:D\geq 0, \ \deg(D)
= d\}$$, then $$\gamma(X)>n$$ if and only if for all $$1\leq d\leq n$$, the
Riemann-Roch space $$\H^0(X;\co_X(D))$$ has dimension $$1$$ for all $$D\in
\div_d(X)$$. The algorithm, therefore, just runs over all $$D\in \div_d(X)$$
(which is finite if $$k$$ is a finite field) and checks if $$\dim
\H^0(X;\co_X(D)) = 1$$; once this is false, we would have found $$\gamma(X)$$.
There is a clear problem with this algorithm when applied to a curve $$X$$ over
a finite field $$\FF_p$$: it is too slow if $$p$$ or the gonality of $$X$$ is
large.

In fact, I think that this problem is *algorithmically* hard! Here is a
heuristic argument, based on the following approach suggested by Maarten. Let
$$D$$ be a divisor on $$X$$ of degree $$n$$ which *dominates all divisors of
degree $$d$$*, i.e., for all divisors $$D'$$ of degree $$d'< d$$, we have
$$D'\leq D$$. Then, there is a map $$\H^0(X;\co_X(D)) \to
\H^0(X;\co_X(D)/\co_X) \cong \FF_p^n$$; let $$V(D)$$ denote the subspace of
$$\FF_p^n$$ given by the image of this map. Write $$D = \sum_{i=0}^k m_i P_i$$,
so that $$n = \sum_{i=0}^k \sum_{j=0}^{m_j} b_{ij}$$, where $$b_i$$ is the
degree of the field of definition of $$P_i$$. This defines a *generalized
Hamming weight* $$h_D$$ as follows: for $$v = (v_{i,j}) \in \FF_p^n =
\bigoplus_{i=0}^k \bigoplus_{j=0}^{m_j} \FF_p^{b_{ij}}$$, let $$h_D(v) =
\sum_{i=0}^k \sum_{j=0}^{\ell_i} b_{ij}$$, where for a fixed $$i$$, $$\ell_i$$
is the largest $$j$$ for which $$v_{i,j} = 0$$. It is then the case that
$$\gamma(C) = d'$$ for $$d'\leq d$$ if and only if the minimum distance
$$\ell(V) = \min_{v\in V-\{0\}} h_D(v)$$ is $$d'$$. The problem of computing
gonalities therefore reduces to the problem of computing the minimum distance
of a linear subspace $$V$$ of $$\FF_p^n$$ with respect to the generalized
Hamming weight given by a partition of $$n$$ as $$\sum_{i=0}^k \sum_{j=0}^{m_j}
b_{ij}$$.

Getting back to number theory, another observation is that the algorithm above
doesn't really use the fact that the curve $$X$$ under consideration is very
special; let's try to specialize to the cases where we need to compute the
gonality. The first case not addressed by Derickx and Sutherland's paper is
$$d=7$$, and at the end of their introduction, they say that the outstanding
problem in computing $$\Phi^\infty(7)$$ is showing that
$$\gamma(X_1(2,2n)_\QQ)> 7$$ for $$11\leq n\leq 15$$. In these cases, it is
pretty hard to use the algorithm above to prove such a lower bound on the
gonality of $$X_1(2,2n)$$ (which, I imagine, is why it isn't done in the
paper). One needs something a bit better.

Instead of considering the curve $$X_1(2,2n)$$, let us consider the curve
$$X_1(2,n)$$ for *odd* $$n$$. Let $$M_{\Gamma_1(n;2)}$$ be the associated
moduli stack over $$\Z$$, so that $$\M_{\Gamma_1(n;2)}$$ is a proper flat
regular Artin stack (see Theorem 1.2.1
[here](http://math.stanford.edu/~conrad/papers/kmpaper.pdf)). Then by Theorem
13.7.6 of
[Katz-Mazur](https://www.dropbox.com/s/30m4quzm3h79ywx/katz-mazur.pdf?raw=1)
(one of my favorite books of all time), the fiber $$X_1(2,n)_{\ol{\FF_2}}$$ of
the Artin stack $$\M_{\Gamma_1(n;2)}$$ is a gluing of two copies of
$$X_1(n)_{\ol{\FF_2}}^{(2)}$$ --- the extension of scalars of
$$X_1(n)_{\ol{\FF_2}}$$ by Frobenius --- at the supersingular points. (Think in
analogy to the famous picture of $$X_0(p)_{\ol{\FF_p}}$$ as being two copies of
$$\PP^1_{\ol{\FF_p}} = X(1)_{\ol{\FF_p}}$$ glued at the supersingular point.)
This is good, because we [know](https://arxiv.org/abs/1307.5719) the gonality
of $$X_1(n)$$, at least for small $$n$$. However, it is not so clear how one
might compare the gonality of a curve (in our case, $$X_1(2,n)$$) and the
gonality of a minimal regular model of it over a prime of *bad* reduction. In
any case, I proposed this idea to Maarten, and he pointed me to a [masters
thesis](https://www.universiteitleiden.nl/binaries/content/assets/science/mi/scripties/master/algant/2016-2017/noordman-master_thesis.pdf)
which implements exactly this idea. I haven't had a chance to read the paper in
detail, but it seems like the fact that the curve $$X_1(n)_{\ol{\FF_2}}$$ is
*smooth* (which is true because $$n$$ was assumed to be odd) is key. This is no
longer true for the fiber over $$\ol{\FF_2}$$ of the curve $$X_1(2,n)$$ for
*even* $$n$$. I don't know if this fiber has been studied (I don't know how to
google this sort of thing), but as far as I know, it isn't covered in
Katz-Mazur, at least. Nonetheless, it might be possible to modify the portions
of the proof in Chapter 13 of their book to obtain some partial results that'd
be sufficient to use techniques similar to the thesis linked to above in order
to obtain lower bounds on $$\gamma(X_1(2,n))$$.
